= ansible-cli.sh

// +-----------------------------------------------+
// |                                               |
// |    DO NOT EDIT HERE !!!!!                     |
// |                                               |
// |    File is auto-generated by pipline.         |
// |    Contents are based on bash script docs.    |
// |                                               |
// +-----------------------------------------------+


Command line interface to run Ansible playbooks.

== Overview

This script allows installation / uninstallation of ansible galaxy modules (see script for
for modules list) and running Ansible playbooks. Ansible runs in a Docker container.

To run playbooks successfully, make sure to run `ssh-copy-id <REMOTE_USER>@<REMOTE_SERVER>.fritz.box`
first ensure seamless connects to all remote machines.

----
ssh-copy-id sebastian@caprica.fritz.box
ssh-copy-id sebastian@kobol.fritz.box
ssh-copy-id pi@prometheus.fritz.box
----

NOTE: Ansible expects the user `sebastian` to be present on all nodes. This user is the default
user for each node (workstation and RasPi). Normally this user is created from the setup wizard.
This scripts exits with `exitcode=8` if this user does not exist.

=== Script Arguments

The script does not accept any parameters.

== Index

* <<invoke,invoke>>
* <<ansible,ansible>>
* <<ansible-playbook,ansible-playbook>>
* <<ansible-galaxy,ansible-galaxy>>

=== invoke

Wrapper function to encapsulate ansible in a docker container using the
link:https://hub.docker.com/r/cytopia/ansible[cytopia/ansible] image.

Ansible runs in Docker as non-root user (the current user from the host is used inside the container).
Filesystem dependencies are mounted into the container to ensure the user inside the container shares
all relevant information with the user from the host.

The current working directory is mounted into the container and selected as working directory so that
all file of the project are available. Paths are preserved.

==== Example

[,bash]
----
echo "test: $(invoke ansible --version)"
----

==== Arguments

* *...* (String): The ansible commands (1-n arguments) - $1 is mandatory

==== Exit codes

* *8*: If param with ansible command is missing

=== ansible

Facade to map `ansible` command. The actual Ansible execution is delegated to
Ansible running in a Docker container.

==== Example

[,bash]
----
echo "test: $(ansible --version)"
----

==== Arguments

* *...* (String): The ansible-playbook commands (1-n arguments) - $1 is mandatory

=== ansible-playbook

Facade to map `ansible-playbook` command. The actual Ansible execution is delegated to
Ansible running in a Docker container.

==== Example

[,bash]
----
echo "test: $(ansible-playbook playbook.yml)"
----

==== Arguments

* *...* (String): The ansible-playbook commands (1-n arguments) - $1 is mandatory

=== ansible-galaxy

Facade to map `ansible-galaxy` command. The actual Ansible execution is delegated to
Ansible running in a Docker container.

==== Example

[,bash]
----
echo "test: $(ansible-galaxy install <extension>)"
----

==== Arguments

* *...* (String): The ansible-galaxy commands (1-n arguments) - $1 is mandatory
